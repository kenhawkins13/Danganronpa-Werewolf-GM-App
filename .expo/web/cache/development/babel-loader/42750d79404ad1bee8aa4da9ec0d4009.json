{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\kenha\\\\source\\\\repos\\\\Danganronpa-Chou-Koukou-Kyuu-No-Jinrou-App\\\\app\\\\pages\\\\NightTime.tsx\";\nimport { useNavigation } from '@react-navigation/native';\nimport * as Speech from 'expo-speech';\nimport React, { useContext, useState } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableHighlight from \"react-native-web/dist/exports/TouchableHighlight\";\nimport Modal from \"react-native-web/dist/exports/Modal\";\nimport { AppContext } from \"../../App\";\nimport NavigationBar from \"../components/NavigationBar\";\nimport PlayersScreen from \"../components/PlayersScreen\";\nimport { nightTimeButtonTexts, nightTimeLabelTexts, nightTimeSpeeches } from \"../data/NightTimeDialogue\";\nexport default function NightTimePage() {\n  var navigation = useNavigation();\n  var appContext = useContext(AppContext);\n\n  var _useState = useState(0),\n      _useState2 = _slicedToArray(_useState, 2),\n      step = _useState2[0],\n      setStep = _useState2[1];\n\n  var _useState3 = useState(undefined),\n      _useState4 = _slicedToArray(_useState3, 2),\n      modalType = _useState4[0],\n      setModalType = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      modalVisible = _useState6[0],\n      setModalVisible = _useState6[1];\n\n  Speech.speak(nightTimeSpeeches(appContext.dayNumber)[step], {\n    onDone: function onDone() {}\n  });\n  return React.createElement(View, {\n    style: {\n      flex: 1\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 19,\n      columnNumber: 5\n    }\n  }, React.createElement(View, {\n    style: {\n      flex: 1,\n      alignItems: 'center',\n      justifyContent: 'center',\n      backgroundColor: 'lightblue'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }\n  }, React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 21,\n      columnNumber: 9\n    }\n  }, \"Night Time of Day \", appContext.dayNumber)), React.createElement(View, {\n    style: {\n      flex: 9\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 23,\n      columnNumber: 7\n    }\n  }, React.createElement(View, {\n    style: {\n      flex: 1,\n      alignItems: 'center',\n      justifyContent: 'center',\n      backgroundColor: '#cc0066'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 24,\n      columnNumber: 9\n    }\n  }, React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 25,\n      columnNumber: 11\n    }\n  }, nightTimeLabelTexts(appContext.dayNumber)[step])), React.createElement(View, {\n    style: {\n      flex: 1,\n      backgroundColor: 'white'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 27,\n      columnNumber: 9\n    }\n  }, React.createElement(TouchableHighlight, {\n    style: {\n      width: '100%',\n      height: '100%',\n      alignItems: 'center',\n      justifyContent: 'center'\n    },\n    onPress: function onPress() {\n      sequence(step, setStep, setModalVisible, appContext, navigation, setModalType);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 28,\n      columnNumber: 11\n    }\n  }, React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 30,\n      columnNumber: 13\n    }\n  }, nightTimeButtonTexts(appContext.dayNumber)[step])))), React.createElement(View, {\n    style: {\n      flex: 1\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 34,\n      columnNumber: 7\n    }\n  }, React.createElement(NavigationBar, {\n    previousPage: \"ItemsPage\",\n    nextPage: \"MorningTimePage\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 35,\n      columnNumber: 9\n    }\n  })), React.createElement(Modal, {\n    visible: modalVisible,\n    style: {\n      flex: 1\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 37,\n      columnNumber: 7\n    }\n  }, React.createElement(View, {\n    style: {\n      flex: 9\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 38,\n      columnNumber: 9\n    }\n  }, React.createElement(PlayersScreen, {\n    modal: modalType,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 11\n    }\n  })), React.createElement(View, {\n    style: {\n      flex: 1\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 9\n    }\n  }, React.createElement(TouchableHighlight, {\n    style: {\n      flex: 1,\n      alignItems: 'center',\n      justifyContent: 'center',\n      backgroundColor: '#0066ff'\n    },\n    onPress: function onPress() {\n      sequence(step, setStep, setModalVisible, appContext, navigation, setModalType);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 11\n    }\n  }, React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 13\n    }\n  }, \"OK\")))));\n}\n\nfunction setStepAsync(step, setStep) {\n  return _regeneratorRuntime.async(function setStepAsync$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          return _context.abrupt(\"return\", new Promise(function () {\n            setTimeout(function () {\n              setStep(step + 1);\n            }, 5 * 1000);\n          }));\n\n        case 1:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, null, Promise);\n}\n\nfunction setStepAsync2() {\n  return _regeneratorRuntime.async(function setStepAsync2$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          return _context2.abrupt(\"return\", new Promise(function () {\n            setTimeout(function () {\n              console.log('hi');\n            }, 2 * 1000);\n          }));\n\n        case 1:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, null, null, null, Promise);\n}\n\nfunction waitForSpeech() {\n  return _regeneratorRuntime.async(function waitForSpeech$(_context3) {\n    while (1) {\n      switch (_context3.prev = _context3.next) {\n        case 0:\n          _context3.next = 2;\n          return _regeneratorRuntime.awrap(Speech.isSpeakingAsync());\n\n        case 2:\n          _context3.t0 = _context3.sent;\n\n          if (!(_context3.t0 === true)) {\n            _context3.next = 5;\n            break;\n          }\n\n          setTimeout(waitForSpeech(), 1000);\n\n        case 5:\n        case \"end\":\n          return _context3.stop();\n      }\n    }\n  }, null, null, null, Promise);\n}\n\nfunction wait() {\n  var location;\n  return _regeneratorRuntime.async(function wait$(_context4) {\n    while (1) {\n      switch (_context4.prev = _context4.next) {\n        case 0:\n          _context4.next = 2;\n          return _regeneratorRuntime.awrap(Speech.isSpeakingAsync());\n\n        case 2:\n          location = _context4.sent;\n\n          if (location) {\n            setTimeout(wait, 1000);\n          }\n\n        case 4:\n        case \"end\":\n          return _context4.stop();\n      }\n    }\n  }, null, null, null, Promise);\n}\n\nfunction sequence(step, setStep, setModalVisible, appContext, navigation, setModalType) {\n  return _regeneratorRuntime.async(function sequence$(_context5) {\n    while (1) {\n      switch (_context5.prev = _context5.next) {\n        case 0:\n          _context5.next = 2;\n          return _regeneratorRuntime.awrap(Speech.stop());\n\n        case 2:\n          _context5.next = 4;\n          return _regeneratorRuntime.awrap(setStepAsync(step, setStep));\n\n        case 4:\n          if (!(appContext.dayNumber === 0)) {\n            _context5.next = 18;\n            break;\n          }\n\n          _context5.t0 = step;\n          _context5.next = _context5.t0 === 0 ? 8 : _context5.t0 === 1 ? 9 : _context5.t0 === 2 ? 10 : _context5.t0 === 3 ? 13 : _context5.t0 === 4 ? 15 : 16;\n          break;\n\n        case 8:\n          return _context5.abrupt(\"break\", 16);\n\n        case 9:\n          return _context5.abrupt(\"break\", 16);\n\n        case 10:\n          appContext.playersInfo.forEach(function (playerInfo) {\n            playerInfo.status = playerInfo.role == 'Blackened' ? 'despair' : 'hope';\n          });\n          setModalVisible(true);\n          return _context5.abrupt(\"break\", 16);\n\n        case 13:\n          setModalVisible(false);\n          return _context5.abrupt(\"break\", 16);\n\n        case 15:\n          navigation.push('MorningTimePage');\n\n        case 16:\n          _context5.next = 33;\n          break;\n\n        case 18:\n          if (!(appContext.dayNumber === 1)) {\n            _context5.next = 33;\n            break;\n          }\n\n          _context5.t1 = step;\n          _context5.next = _context5.t1 === 0 ? 22 : _context5.t1 === 1 ? 26 : _context5.t1 === 2 ? 28 : _context5.t1 === 3 ? 30 : _context5.t1 === 4 ? 32 : 33;\n          break;\n\n        case 22:\n          setModalType('itemCards');\n          appContext.playersInfo.forEach(function (playerInfo) {\n            playerInfo.status = 'hope';\n          });\n          setModalVisible(true);\n          return _context5.abrupt(\"break\", 33);\n\n        case 26:\n          setModalVisible(false);\n          return _context5.abrupt(\"break\", 33);\n\n        case 28:\n          setModalVisible(true);\n          return _context5.abrupt(\"break\", 33);\n\n        case 30:\n          setModalVisible(false);\n          return _context5.abrupt(\"break\", 33);\n\n        case 32:\n          navigation.push('MorningTimePage');\n\n        case 33:\n        case \"end\":\n          return _context5.stop();\n      }\n    }\n  }, null, null, null, Promise);\n}","map":{"version":3,"sources":["C:/Users/kenha/source/repos/Danganronpa-Chou-Koukou-Kyuu-No-Jinrou-App/app/pages/NightTime.tsx"],"names":["useNavigation","Speech","React","useContext","useState","AppContext","NavigationBar","PlayersScreen","nightTimeButtonTexts","nightTimeLabelTexts","nightTimeSpeeches","NightTimePage","navigation","appContext","step","setStep","undefined","modalType","setModalType","modalVisible","setModalVisible","speak","dayNumber","onDone","flex","alignItems","justifyContent","backgroundColor","width","height","sequence","setStepAsync","Promise","setTimeout","setStepAsync2","console","log","waitForSpeech","isSpeakingAsync","wait","location","stop","playersInfo","forEach","playerInfo","status","role","push"],"mappings":"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","sourcesContent":["import { useNavigation } from '@react-navigation/native';\r\nimport * as Speech from 'expo-speech'\r\nimport React, { useContext, useState } from 'react'\r\nimport { View, Text, TouchableHighlight, Modal } from 'react-native'\r\nimport { AppContext } from '../../App';\r\nimport NavigationBar from '../components/NavigationBar'\r\nimport PlayersScreen from '../components/PlayersScreen'\r\nimport { nightTimeButtonTexts, nightTimeLabelTexts, nightTimeSpeeches } from '../data/NightTimeDialogue';\r\nimport { AppContextType } from '../types/types'\r\n\r\nexport default function NightTimePage() {\r\n  const navigation = useNavigation()\r\n  const appContext = useContext(AppContext)\r\n  const [step, setStep] = useState(0)\r\n  const [modalType, setModalType] = useState(undefined)\r\n  const [modalVisible, setModalVisible] = useState(false)\r\n  Speech.speak(nightTimeSpeeches(appContext.dayNumber)[step], {onDone: () => {}})\r\n  return (\r\n    <View style={{ flex: 1 }}>\r\n      <View style={{ flex: 1, alignItems: 'center', justifyContent: 'center', backgroundColor: 'lightblue' }}>\r\n        <Text>Night Time of Day {appContext.dayNumber}</Text>\r\n      </View>\r\n      <View style={{ flex: 9 }}>\r\n        <View style={{ flex: 1, alignItems: 'center', justifyContent: 'center', backgroundColor: '#cc0066' }}>\r\n          <Text>{nightTimeLabelTexts(appContext.dayNumber)[step]}</Text>\r\n        </View>\r\n        <View style={{ flex: 1, backgroundColor: 'white' }}>\r\n          <TouchableHighlight style={{ width: '100%', height: '100%', alignItems: 'center', justifyContent: 'center' }} \r\n            onPress={() => { sequence(step, setStep, setModalVisible, appContext, navigation, setModalType) }}>\r\n            <Text>{nightTimeButtonTexts(appContext.dayNumber)[step]}</Text>\r\n          </TouchableHighlight>\r\n        </View>\r\n      </View>\r\n      <View style={{ flex: 1 }}>\r\n        <NavigationBar previousPage='ItemsPage' nextPage='MorningTimePage'></NavigationBar>\r\n      </View>\r\n      <Modal visible={modalVisible} style={{ flex: 1 }}>\r\n        <View style={{ flex: 9 }}>\r\n          <PlayersScreen modal={modalType}></PlayersScreen>\r\n        </View>\r\n        <View style={{ flex: 1 }}>\r\n          <TouchableHighlight style={{ flex: 1, alignItems: 'center', justifyContent: 'center', backgroundColor: '#0066ff' }} \r\n            onPress={() => { sequence(step, setStep, setModalVisible, appContext, navigation, setModalType) }}>\r\n            <Text>OK</Text>\r\n          </TouchableHighlight>\r\n        </View>\r\n      </Modal>\r\n    </View>\r\n  )\r\n}\r\n\r\nasync function setStepAsync(step:number, setStep:React.Dispatch<any>): Promise<void> {\r\n  return new Promise(() => { setTimeout(() => { setStep(step + 1) }, (5 * 1000))})\r\n}\r\nasync function setStepAsync2(): Promise<void> {\r\n  return new Promise(() => { setTimeout(() => { console.log('hi') }, (2 * 1000))})\r\n}\r\nasync function waitForSpeech() {\r\n  if ( await Speech.isSpeakingAsync() === true ) {\r\n    setTimeout( waitForSpeech(), 1000 )\r\n  }\r\n}\r\n\r\nasync function wait() {\r\n  var location = await Speech.isSpeakingAsync();\r\n  if (location) {\r\n    setTimeout(wait, 1000)\r\n  }\r\n}\r\n\r\nasync function sequence(step:number, setStep:React.Dispatch<any>, setModalVisible:React.Dispatch<any>, appContext:AppContextType, navigation:any, setModalType:React.Dispatch<any>) {\r\n  await Speech.stop()\r\n  await setStepAsync(step, setStep)\r\n  if (appContext.dayNumber === 0) {\r\n    switch (step) {\r\n      case 0:\r\n        break\r\n      case 1:\r\n        break\r\n      case 2:\r\n        appContext.playersInfo.forEach(playerInfo => {\r\n          playerInfo.status = playerInfo.role == 'Blackened' ? 'despair' : 'hope'\r\n        })\r\n        setModalVisible(true)\r\n        break\r\n      case 3:\r\n        setModalVisible(false)\r\n        break\r\n      case 4:\r\n        navigation.push('MorningTimePage')\r\n    }\r\n  } else if (appContext.dayNumber === 1) {\r\n    switch (step) {\r\n      case 0:\r\n        setModalType('itemCards')\r\n        appContext.playersInfo.forEach(playerInfo => {\r\n          playerInfo.status = 'hope'\r\n        })\r\n        setModalVisible(true)\r\n        break\r\n      case 1:\r\n        setModalVisible(false)\r\n        break\r\n      case 2:\r\n        setModalVisible(true)\r\n        break\r\n      case 3:\r\n        setModalVisible(false)\r\n        break\r\n      case 4:\r\n        navigation.push('MorningTimePage')\r\n    }\r\n  }\r\n}"]},"metadata":{},"sourceType":"module"}